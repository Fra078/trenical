syntax = "proto3";
import "google/protobuf/empty.proto";
import "railway-service.proto";
option java_multiple_files = true;

package it.trenical.proto.train;


service TrainManager {
  rpc RegisterTrainType(RegisterTrainTypeRequest) returns (google.protobuf.Empty);
  rpc GetAllTrainTypes(google.protobuf.Empty) returns (stream TrainTypeResponse);
  rpc GetTrainTypeByName(TrainTypeByNameRequest) returns (TrainTypeResponse);
  rpc RemoveTrainTypeByName(TrainTypeByNameRequest) returns (google.protobuf.Empty);

  rpc RegisterServiceClass(ServiceClass) returns (google.protobuf.Empty);
  rpc GetAllServiceClasses(google.protobuf.Empty) returns (stream ServiceClass);
  rpc GetServiceClassByName(ServiceClassByNameRequest) returns (ServiceClass);
  rpc RemoveServiceClassByName(ServiceClassByNameRequest) returns (google.protobuf.Empty);

  rpc RegisterTrain(RegisterTrainRequest) returns (TrainResponse);
  rpc GetAllTrains(google.protobuf.Empty) returns (stream TrainResponse);
  rpc GetTrainById(TrainId) returns (TrainResponse);
  rpc RemoveTrainById(TrainId) returns (google.protobuf.Empty);
}

message TrainTypeResponse {
  string name = 1;
  double speed = 3;
  double costPerKm = 4;
}

message RegisterTrainTypeRequest {
  string name = 1;
  double speed = 3;
  double costPerKm = 4;
}

message TrainTypeByNameRequest {
  string name = 1;
}

message ServiceClass {
  string name = 1;
  double incrementFactor = 3;
}

message ServiceClassByNameRequest {
  string name = 1;
}

message RegisterTrainRequest {
  string name = 1;
  string typeName = 2;
  int64 departureTime = 3;
  map<string, int32> classSeats = 4;
  map<string, int32> platformChoices = 5;
  int32 pathId = 6;
}

message TrainId {
  int32 id = 1;
}

message ClassSeats {
  ServiceClass serviceClass = 1;
  int32 count = 2;
}

message TrainResponse {
  int32 id = 1;
  string name = 2;
  TrainTypeResponse type = 3;
  int64 departureTime = 4;
  it.trenical.proto.railway.PathResponse path = 5;
  repeated ClassSeats seats = 6;
  map<string, int32> platformChoices = 7;
}