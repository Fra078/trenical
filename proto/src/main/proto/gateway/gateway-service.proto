syntax = "proto3";
import "common.proto";
import "promotion-service.proto";
import "train-service.proto";
import "train/update.proto";
import "ticketry-service.proto";
import "travel/travel-solution.proto";
import "train/service-class.proto";
import "train/train-type.proto";
import "railway-service.proto";
import "ticket/ticket-request.proto";
option java_multiple_files = true;
option java_package="it.trenical.server.gateway.proto";

package gateway;

service TrenicalGateway {
  rpc SubscribeToLoyalty(Empty) returns (Empty);
  rpc UnsubscribeToLoyalty(Empty) returns (Empty);
  rpc GetLoyaltySubscriptionInfo(Empty) returns (promo.GetSubscriptionInfoResponse);
  rpc ListenToLoyaltyPromotions(Empty) returns (stream promo.PromotionMessage);


  rpc GetAllTrainTypes(Empty) returns (stream train.TrainTypeResponse);
  rpc GetAllServiceClasses(Empty) returns (stream train.ServiceClass);
  rpc GetAllStations(Empty) returns (stream railway.StationResponse);

  rpc QueryTravelSolutions(ticketry.TripQueryParams) returns (stream travel.TravelSolution);
  rpc BuyTicket(ticketry.PurchaseTicketRequest) returns (ticketry.TicketConfirm);

  rpc ListenToTrainUpdates(train.ListenToTrainRequest) returns (stream train.TrainUpdate);
  rpc ListenToMyTrainUpdates(Empty) returns (stream train.TrainUpdate);
}